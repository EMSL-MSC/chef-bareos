<%# BAREOS JOBS TEMPLATE %>
# Generated by Chef for <%= node['bareos']['director']['name'] %>-dir
# Local modifications will be overwritten.
#
# Bareos Jobs File

<% unless @jobs.nil? %>
  <% @jobs.each do |job_key, job_value| %>
Job {
  Name = "<%= job_key %>"
    <% job_value.each do |key, value| %>
  <%= key %> = <%= value %>
    <% end %>
}

  <% end %>
<% end %>
<% @bareos_clients.each do |client| %>
  <% unless @client_jobs.nil? %>
    <% @client_jobs.each do |key1,value1| %>
Job {
  Name = "<%= client['bareos']['clients']['name'] %>-job"
  Client = <%= client['bareos']['clients']['net_name'] %>-fd
  Type = Backup
      <% value1.each do |k1, v1| %>
  <%= k1 %> = <%= v1 %>
      <% end %>
}

    <% end %>
  <% end %>
  <% unless @client_restore_jobs.nil? %>
    <% @client_restore_jobs.each do |key2, value2| %>
Job {
  Name = "<%= client['bareos']['clients']['name'] %>-restore-job"
  Client = <%= client['bareos']['clients']['net_name'] %>-fd
  Type = Restore
      <% value2.each do |k2, v2| %>
  <%= k2 %> = <%= v2 %>
      <% end %>
}
    <% end %>
  <% end %>
<% end %>
