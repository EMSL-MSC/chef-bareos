<%# BAREOS JOBS TEMPLATE %>
# Generated by Chef for <%= node['bareos']['director']['name'] %>-dir
# Local modifications will be overwritten.
#
# Bareos Jobs File

<% unless @jobs.nil? %>
  <% @jobs.each do |job_key, job_value| %>
Job {
  Name = "<%= job_key %>"
    <% job_value.each do |key, value| %>
  <%= key %> = <%= value %>
    <% end %>
}

  <% end %>
<% end %>
<% @bareos_clients.each do |client_key, client_jobs| %>
  <% @client_jobs.each do |key1,value1| %>
Job {
  Name = "<%= client_key['hostname'] %>-job"
  Client = <%= client_key['hostname'] %>-fd
  Type = Backup
    <% value1.each do |k1, v1| %>
  <%= k1 %> = <%= v1 %>
    <% end %>
}

  <% end %>
  <% @client_restore_jobs.each do |key2, value2| %>
Job {
  Name = "<%= client_key['hostname'] %>-restore-job"
  Client = <%= client_key['hostname'] %>-fd
  Type = Restore
    <% value2.each do |k2, v2| %>
  <%= k2 %> = <%= v2 %>
    <% end %>
}
  <% end %>
<% end %>
